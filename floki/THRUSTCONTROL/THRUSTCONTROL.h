/*
 * THRUSTCONTROL.h
 *
 *  Created on: 10 Feb 2020
 *      Author: ArnoldPretorius
 */

#ifndef THRUSTCONTROL_H_
#define THRUSTCONTROL_H_

#define THRUSTCONTROL_CURRENT_GAIN	7.518796992481203

#define THRUSTCONTROL_KPHI	0.005968310365946

////clockwise coefficients
//#define THRUSTCONTROL_CW_C1  	(100*-0.009319657757279)//-0.4423739373909
//#define THRUSTCONTROL_CW_C2    (100*0.153552289432084)//8.7594404673584
//#define THRUSTCONTROL_CW_C3  	(100*-0.965008536288175)//-65.9991180774829
//#define THRUSTCONTROL_CW_C4  	(100*3.040878679346105)//250.3726004148456
//#define THRUSTCONTROL_CW_C5  	(100*-1.677407052586646)//-166.1892587943731
//
////counter-clockwise coefficients
//#define THRUSTCONTROL_CCW_C1  	(100*-0.007752395326118)//-0.4423739373909
//#define THRUSTCONTROL_CCW_C2    (100*0.144209603912130)//8.7594404673584
//#define THRUSTCONTROL_CCW_C3  	(100*-0.993635111078620)//-65.9991180774829
//#define THRUSTCONTROL_CCW_C4  	(100*3.318482939020254)//250.3726004148456
//#define THRUSTCONTROL_CCW_C5  	(100*-2.298509910298346)//-166.1892587943731

#define THRUSTCONTROL_B0	-0.0076
#define THRUSTCONTROL_B1	0.141
#define THRUSTCONTROL_B2	-0.974
#define THRUSTCONTROL_B3	3.2521
#define THRUSTCONTROL_B4	-2.253

#define THRUSTCONTROL_X		7.142857142857142
#define THRUSTCONTROL_K		10628
#define THRUSTCONTROL_W_ZERO1	26
#define THRUSTCONTROL_W_ZERO2	44
#define THRUSTCONTROL_W_POLE	247
#define THRUSTCONTROL_UMAX	1500
#define THRUSTCONTROL_SPEED_THRESHOLD 40

#define THRUSTCONTROL_ESTIMATOR_CUTOFF_FREQUENCY (2*M_PI*150) //rad/s

#include "Arduino.h"
#include "common.h"
#include "MOTORSPEEDCONTROL.h"
#include "ENCODER.h"
#include "LED.h"

class THRUSTCONTROL
{
	public:
		static void initialise();
		static void iterate();
		static void getThrustEstimates();

		static float current[4],thrustEstimate[4],thrustReference[4],servoCommand[4];
};

#endif /* THRUSTCONTROL_H_ */
